<!DOCTYPE html>
<html>

<head>
  <title>Display Platform Name</title>
</head>

<body>
  <script>
    //get the receipt name from parameters
    const urlParams = new URLSearchParams(window.location.search);
    const fileName = urlParams.get('fileName');
    const url = "https://storage.googleapis.com/e-receipt-b118e.appspot.com/";

    // Construct the new URL with the data
    const redirectURL = `intent://com.example.e_receipt_app?fileName=${url}${fileName}#Intent;scheme=https;package=com.example.e_receipt_app;end`;

    /*     // Display the platform name
        const displayElement = document.createElement('div');
        displayElement.textContent = 'Platform: ' + platformName;
        document.body.appendChild(displayElement); */

    //Checks if os is android
    const platformName = navigator.platform;
    const isAndroid = /Android/.test(navigator.userAgent);

    //display isAndroid
    const displayElement = document.createElement('header');
    displayElement.textContent = 'IsAndroid: ' + isAndroid;
    document.body.appendChild(displayElement);

    if (isAndroid)
    {
      // Redirect the user to app if on android
      window.location.replace(redirectURL);
    }
    else
    {
      // Download the json receipt
      fetch(`${url}${fileName}`, {
        mode: 'no-cors'
      })
        .then(response =>
        {
          if (!response.ok)
          {
            throw new Error('Network response was not ok');
          }
          return response.json(); // Parse response as JSON
        })
        .then(data =>
        {
          // Display the JSON data in a readable format
          const displayElement = document.createElement('receipt');
          displayElement.textContent = JSON.stringify(data, null, 2);;
          document.body.appendChild(displayElement);
        })
        .catch(error =>
        {
          console.error('Error loading JSON:', error)
        });
    }
  </script>
</body>

</html>